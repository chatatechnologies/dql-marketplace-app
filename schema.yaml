x-google-marketplace:
  schemaVersion: v2

  applicationApiVersion: v1beta1

  publishedVersion: '1.0.0'
  publishedVersionMetadata:
    releaseNote: >-
      A first initial release to test.

  images: 
    '':
      properties:
        DEPLOYABLE_VM_IMAGE:
          type: FULL
        IMAGE_TAG:
          type: TAG

properties:
  INSTANCE_NAME:
    type: string
    x-google-marketplace:
      type: NAME

  NAMESPACE:
    type: string
    x-google-marketplace:
      type: NAMESPACE

  STORAGE_CLASS:
    type: string
    title: StorageClass
    description: You can choose an existing StorageClass or create a new one.
    x-google-marketplace:
      type: STORAGE_CLASS
      storageClass:
        type: SSD

  SERVICE_ACCOUNT:
    type: string
    x-google-marketplace:
      type: SERVICE_ACCOUNT
      serviceAccount:
        description: >
          Name of a service account in the target namespace that
          has cluster-admin permissions. This is needed for the operator
          to manage resources.
        roles:
        - type: ClusterRole
          rulesType: CUSTOM
          rules:
            - apiGroups: ["apiextensions.k8s.io"]
              resources: ["customresourcedefinitions"]
              verbs:
                - '*'
            - apiGroups:
              - ""
              resources:
                - pods
                - services
                - endpoints
                - persistentvolumeclaims
                - events
                - configmaps
                - secrets
                - serviceaccounts
                - namespaces
              verbs:
                - '*'
            - apiGroups:
              - apps
              resources:
              - deployments
              - daemonsets
              - replicasets
              - statefulsets
              verbs:
              - '*'
            - apiGroups:
              - extensions
              resources:
              - replicasets
              - deployments
              - daemonsets
              - statefulsets
              - ingresses
              verbs:
                - '*'
            - apiGroups:
              - batch
              resources:
              - jobs
              - cronjobs
              verbs:
              - '*'
            - apiGroups:
              - rbac.authorization.k8s.io
              resources:
              - clusterrolebindings
              verbs:
              - '*'
            - apiGroups:
              - rbac.authorization.k8s.io
              resources:
              - clusterroles
              verbs:
              - '*'
            - apiGroups:
              - rbac.authorization.k8s.io
              resources:
              - rolebindings
              verbs:
              - '*'
            - apiGroups:
              - admissionregistration.k8s.io
              resources:
              - validatingwebhookconfigurations
              verbs:
              - '*'
            - apiGroups:
              - admissionregistration.k8s.io
              resources:
              - mutatingwebhookconfigurations
              verbs:
              - '*'
            - apiGroups:
              - apiregistration.k8s.io
              resources:
              - apiservices
              verbs:
              - '*'
            - apiGroups:
              - certificates.k8s.io
              resources:
              - certificatesigningrequests
              - certificatesigningrequests/approval
              verbs:
              - create
              - delete
              - get
              - list
              - watch
              - update
            - apiGroups:
              - authentication.k8s.io
              resources:
              - tokenreviews
              - subjectaccessreviews
              verbs:
              - create

  PEM_SECRET:
    type: string
    default: eyJzZWNyZXRfa2V5IjogInhwU2djbUd6dGUyNkN4b3RUMUllVkcyTTdVRWg2MDkwZEFIRHRUQ1lHR3gtN29PUndlVm16dkxIMHljeUxTQnFYaHBqZHFLVW9KUEF5ZUpqMlpLYUQ0SXVNMGZfMW1XbUVCSF9ONFliSUpEMTUtSUhhNHpvNGhaa1dKaTJtYnBPTjY2emtFNUw4Nk5LR2hRcmUzZDF2NnYzSHJEWEJEb3BVcWhDZ0ZQdk91ZFhORWw0VGlSUmk3ZTlUZnRoTVh0TTJ5OFpFd2M5cUV3RzhORnNzT0ktbHBVTzRJNVZZVm9iTVREMUU2c3dtMjdfS2xZeDEwa1Z2bzFuemhOam1PMlVHN1pxZXVPc2I1WFZGMDF4Z3Y2N0EtTTJPcU9MalFQcDV4OXJiMUVWSno5d1MyN0QtTk1PZklkYV8tVWdHbTBsUVIxR3dIU2YwV2doX0M4WXNaX0xidkNKeXlsRGRqMUxwVGJyYmt5WVItM25pZXh6OHFVT1RsWWVKN1pZV0NHMHFUOHlIRUpYbWVGdWltOFlsbHNxOFZhRm1wOEpwa3dkT0dRMXJVVm9iYXZhb1k1YWNYTDF5b2xHOWx1YUx0RG53Sks2WjZ2MDl6OExVS3VTSm1xd3NvOHBSY0YzbDcwMlNhNXhZR1E2S2pRLTU3V0pYNENZMGlPazJZNHd1dTFFVUVIakxuU1pFRUozVHU1NUlwalRXMERvWGlpRDJqWlR5Zm8xd3pfUE1hdURKSUJLaEtVWXhucjFvVkQxUzFIbHl4NnNWVUNtcUUzbTdFQ2tIdVllWC12aTJtNGs1UXk2am8wUm9PTkpWRi1CbEQyMmJkNGFRZmRubFRKd2xLNHlzUFBVR3QxVzN3S3ZTVVFvV0lnZFRGeTdtYnlXX1ljRzBnelZjaV9zdGZVIiwgImF1ZGllbmNlIjogImI3ZmY1NTQwLTI2MmMtNDA0ZS05ZWRkLWRiYTE0MWE5MWZjMyJ9
    description: base64 encoded value of pem file for portal authentication
    x-google-marketplace:
      type: STRING

required:
- INSTANCE_NAME
- NAMESPACE
- STORAGE_CLASS
- SERVICE_ACCOUNT
- PEM_SECRET